<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Cakeria - Minha Área | Dashboard</title>

    <link rel="icon" href="/assets/favicon.ico" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./css/styles.css" />
    <link rel="stylesheet" href="./css/home.css" />
    <link rel="stylesheet" href="/components/components.css" />

    <script src="/components/Footer.js"></script>
  </head>
  <body>
    <header-component></header-component>

    <main class="home-main">
      <section id="receitas" class="section-receitas">
        <div class="container">
          <div class="section-header">
            <h2>Receitas em Destaque</h2>
            <a href="receitas.html" class="view-all">Ver Todas</a>
          </div>

          <div class="receitas-grid">
            <div class="loading-indicator">
              <div class="spinner"></div>
              <p>Carregando receitas...</p>
            </div>
          </div>
        </div>
      </section>

      <section id="pedidos" class="section-pedidos">
        <div class="container">
          <div class="section-header">
            <h2>Meus Pedidos</h2>
            <a href="/pedidos.html" class="view-all">Ver Todos</a>
          </div>
          <div class="pedidos-status">
            <div class="status-card">
              <div class="status-icon pending">
                <i class="fas fa-clock"></i>
              </div>
              <div class="status-info">
                <h3>Pendentes</h3>
                <p class="status-count">0</p>
              </div>
            </div>

            <div class="status-card">
              <div class="status-icon processing">
                <i class="fas fa-spinner"></i>
              </div>
              <div class="status-info">
                <h3>Em Preparo</h3>
                <p class="status-count">0</p>
              </div>
            </div>

            <div class="status-card">
              <div class="status-icon delivered">
                <i class="fas fa-check-circle"></i>
              </div>
              <div class="status-info">
                <h3>Entregues</h3>
                <p class="status-count">0</p>
              </div>
            </div>

            <div class="status-card">
              <div class="status-icon new-order">
                <i class="fas fa-plus-circle"></i>
              </div>
              <div class="status-info">
                <h3>Novo Pedido</h3>
                <a href="/produtos.html" class="btn btn-sm btn-primary">Fazer Pedido</a>
              </div>
            </div>
          </div>

          <div class="recent-orders">
            <h3>Pedidos Recentes</h3>
            <div class="order-list">
              <!-- Os pedidos serão carregados dinamicamente pelo JavaScript -->
              <div class="loading-indicator">
                <div class="spinner"></div>
                <p>Carregando pedidos...</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="compartilhar" class="section-compartilhar">
        <div class="container">
          <div class="compartilhar-content">
            <div class="compartilhar-info">
              <h2>Compartilhe Suas Receitas</h2>
              <p>
                Mostre seu talento culinário para a comunidade Cakeria. Compartilhe suas criações e
                inspire outros confeiteiros.
              </p>

              <ul class="compartilhar-benefits">
                <li>Ganhe reconhecimento da comunidade</li>
                <li>Receba feedback de outros confeiteiros</li>
                <li>Participe de desafios mensais</li>
                <li>Concorra a prêmios exclusivos</li>
              </ul>

              <a href="/compartilhar-receita.html" class="btn btn-primary">Compartilhar Receita</a>
            </div>

            <div class="compartilhar-image">
              <img src="./assets/share-menu.svg" alt="compartilhar receita" />
            </div>
          </div>
        </div>
      </section>

      <section id="minhas-receitas" class="section-minhas-receitas">
        <div class="container">
          <div class="section-header">
            <h2>Minhas Receitas</h2>
            <a href="/minhas-receitas.html" class="view-all">Ver Todas</a>
          </div>

          <div class="receitas-tabs">
            <button class="tab-btn active" data-tab="publicadas">Publicadas</button>
            <button class="tab-btn" data-tab="favoritas">Favoritas</button>
            <button class="tab-btn" data-tab="rascunhos">Rascunhos</button>
            <button class="tab-btn" data-tab="feitas">Receitas que Fiz</button>
          </div>
          <div id="publicadas" class="tab-content active">
            <div class="receitas-grid">
              <!-- As receitas publicadas serão carregadas dinamicamente pelo JavaScript -->
              <div class="loading-indicator">
                <div class="spinner"></div>
                <p>Carregando receitas...</p>
              </div>
            </div>
          </div>

          <div id="favoritas" class="tab-content">
            <!-- As receitas favoritas serão carregadas dinamicamente pelo JavaScript -->
            <div class="loading-indicator">
              <div class="spinner"></div>
              <p>Carregando favoritos...</p>
            </div>
          </div>

          <div id="rascunhos" class="tab-content">
            <!-- Os rascunhos serão carregados dinamicamente pelo JavaScript -->
            <div class="loading-indicator">
              <div class="spinner"></div>
              <p>Carregando rascunhos...</p>
            </div>
          </div>

          <div id="feitas" class="tab-content">
            <div class="empty-state">
              <img src="/assets/icons/cooking.svg" alt="Cozinhando" class="empty-icon" />
              <h3>Nenhuma receita marcada como feita</h3>
              <p>Quando você fizer uma receita, marque-a como "Feita" para registrar aqui.</p>
              <a href="./receitas.html" class="btn btn-primary">Explorar Receitas</a>
            </div>
          </div>
        </div>
      </section>

      <section class="section-newsletter">
        <div class="container">
          <div class="newsletter-content">
            <h2>Receba Nossas Novidades</h2>
            <p>
              Inscreva-se para receber receitas exclusivas, dicas de confeitaria e novidades da
              Cakeria.
            </p>

            <form class="newsletter-form">
              <input type="email" placeholder="Seu melhor e-mail" required />
              <button type="submit" class="btn btn-primary">Inscrever-se</button>
            </form>
          </div>
        </div>
      </section>
    </main>

    <footer-component></footer-component>
    <script src="./js/utils/toast.js"></script>
    <script src="./js/api.js"></script>
    <script src="./components/Header.js"></script>
    <script src="./js/header-controller.js"></script>
    <script src="./js/login.js"></script>
    <script src="./js/receitas.js"></script>
    <script src="./js/auth-guard.js"></script>
    <script src="./js/navegacao.js"></script>
    <script src="./js/logout.js"></script>
    <script src="./js/home.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        try {
          const justLoggedIn = sessionStorage.getItem('justLoggedIn');

          if (justLoggedIn === 'true') {
            const user = JSON.parse(localStorage.getItem('user'));
            if (user && user.name && window.Toast) {
              window.Toast.success(`Bem-vindo(a), ${user.name}!`, {
                position: 'bottom-right',
                duration: 4000,
              });
            }
            sessionStorage.removeItem('justLoggedIn');
          }

          const lastLogin = localStorage.getItem('lastLoginDate');
          const today = new Date().toDateString();

          if (lastLogin !== today && window.Toast) {
            localStorage.setItem('lastLoginDate', today);

            setTimeout(() => {
              Toast.info('Confira nossas novidades!', {
                title: 'Sugestão do dia',
                duration: 5000,
                position: 'bottom-right',
              });
            }, 2000);
          }

          const tabButtons = document.querySelectorAll('.tab-btn');
          if (tabButtons.length > 0) {
            tabButtons.forEach(btn => {
              btn.addEventListener('click', function () {
                const tabName = this.dataset.tab;
                if (window.Toast && tabName) {
                  const messages = {
                    publicadas: 'Visualizando suas receitas publicadas',
                    favoritas: 'Suas receitas favoritas',
                    rascunhos: 'Seus rascunhos de receitas',
                    feitas: 'Receitas que você já fez',
                  };

                  if (messages[tabName]) {
                    Toast.info(messages[tabName], {
                      duration: 2000,
                      position: 'bottom-right',
                    });
                  }
                }
              });
            });
          }
        } catch (error) {
          console.error('Erro ao processar informações do usuário:', error);
        }
      });
    </script>
  </body>
</html>
